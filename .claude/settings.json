{
  "env": {
    "CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS": "1"
  },
  "permissions": {
    "defaultMode": "bypassPermissions"
  },
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "command",
            "command": "bash -c 'INPUT=$(cat); FILE=$(echo \"$INPUT\" | jq -r \".tool_input.file_path // empty\"); [ -z \"$FILE\" ] && exit 0; DIR=$(dirname \"$FILE\"); [ ! -d \"$DIR\" ] && exit 0; GD=$(cd \"$DIR\" && git rev-parse --git-dir 2>/dev/null) || exit 0; GC=$(cd \"$DIR\" && git rev-parse --git-common-dir 2>/dev/null) || exit 0; AGD=$(cd \"$DIR\" && cd \"$GD\" && pwd); AGC=$(cd \"$DIR\" && cd \"$GC\" && pwd); if [ \"$AGD\" = \"$AGC\" ]; then echo \"BLOCKED: Edits must happen in a git worktree, not the main checkout.\" >&2; echo \"Create a worktree first: git worktree add /tmp/spawn-worktrees/FEATURE -b branch-name\" >&2; echo \"Then use absolute paths under /tmp/spawn-worktrees/FEATURE/ for all edits.\" >&2; exit 2; fi; BRANCH=$(cd \"$DIR\" && git rev-parse --abbrev-ref HEAD 2>/dev/null); if [ \"$BRANCH\" = \"main\" ]; then echo \"BLOCKED: Cannot edit on main branch, even in a worktree.\" >&2; echo \"Create a worktree with a feature branch: git worktree add /tmp/spawn-worktrees/FEATURE -b branch-name\" >&2; exit 2; fi'"
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "command",
            "command": "bash -c 'FILE=\"$CLAUDE_FILE\"; if [[ \"$FILE\" == *.sh ]]; then bash -n \"$FILE\" 2>&1 || { echo \"SYNTAX ERROR in $FILE\"; exit 2; }; if grep -qn \"source \\.\\./\\|source \\./\" \"$FILE\" 2>/dev/null; then echo \"RELATIVE SOURCE detected in $FILE — breaks curl|bash execution\"; exit 2; fi; if grep -qn \"echo -e \" \"$FILE\" 2>/dev/null; then echo \"echo -e detected in $FILE — use printf instead (macOS bash 3.x compat)\"; exit 2; fi; if grep -qn \"set -.*u\" \"$FILE\" 2>/dev/null && ! grep -qn \"set -eo pipefail\" \"$FILE\" 2>/dev/null; then echo \"set -u (nounset) detected in $FILE — use set -eo pipefail instead\"; exit 2; fi; fi; if [[ \"$FILE\" == *.ts ]]; then if grep -Pn \"^\\s*//\\s*[-=*#]{10,}\\s*$\" \"$FILE\" 2>/dev/null; then echo \"BANNER COMMENT in $FILE — use // #region Name / // #endregion instead\"; exit 2; fi; fi'"
          }
        ]
      }
    ]
  }
}
